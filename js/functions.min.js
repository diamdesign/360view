export function formatNumber(e){return e>=1e6?(e/1e6).toFixed(1)+"M":e>=1e4?(e/1e3).toFixed(1)+"k":e.toLocaleString()}export function receiveMessage(e){const t=e.data;if("360"===t.identifier)return t}export function dataURItoBlob(e){for(var t=atob(e.split(",")[1]),n=e.split(",")[0].split(":")[1].split(";")[0],o=new ArrayBuffer(t.length),r=new Uint8Array(o),a=0;a<t.length;a++)r[a]=t.charCodeAt(a);return new Blob([o],{type:n})}export function copyToClipboard(e){const t=document.querySelector(e),n=document.createElement("textarea");n.value=t.textContent,document.body.appendChild(n),n.select(),n.setSelectionRange(0,99999),t.classList.add("copyflash"),setTimeout((()=>{t.classList.remove("copyflash")}),300),document.execCommand("copy"),document.body.removeChild(n)}export function getTimeAgo(e){const t=new Date-new Date(e),n=Math.floor(t/1e3),o=Math.floor(n/60),r=Math.floor(o/60),a=Math.floor(r/24),i=Math.floor(a/30),s=Math.floor(a/365);return s>0?s+"y":i>0?i+"m":a>0?a+"d":r>0?r+"h":o+"m"}export function countComments(e){if(!Array.isArray(e))return 0;let t=0;return e.forEach((e=>{t++,e.replies&&Array.isArray(e.replies)&&(t+=e.replies.length)})),t}export function getUrlParameter(e){e=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var t=new RegExp("[\\?&]"+e+"=([^&#]*)").exec(location.search);return null===t?"":decodeURIComponent(t[1].replace(/\+/g," "))}export async function xhrSend(e,t,n,o=null){return new Promise(((r,a)=>{var i=new XMLHttpRequest;i.open(e,t,!0),null===o?i.setRequestHeader("Content-Type","application/x-www-form-urlencoded"):"json"===o&&i.setRequestHeader("Content-Type","application/json"),i.onreadystatechange=function(){if(4===i.readyState)if(200===i.status){var e=i.responseText.trim();if(e.startsWith("[]")){var t=e.substring(2).trim(),n=JSON.parse(t);r(n)}else{n=JSON.parse(e);r(n)}}else a(i.statusText)},i.send(n)}))}export function testInternetSpeed(){return new Promise(((e,t)=>{const n=(new Date).getTime(),o=new Image;o.onload=function(){const t=((509064/(((new Date).getTime()-n)/1e3)).toFixed(2)/1024).toFixed(2);e(t)},o.onerror=function(e){t(e)},o.src="../img/360-low.jpg?n="+Math.random()}))}